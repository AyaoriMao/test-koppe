# テンプレートの作り込み

全パートで正常に動いていればdjangoが期待通りに動いているということが確認できましたので実際に画面(テンプレートを作り込んでいきましょう)

## 静的ファイルのダウンロード
今回はdjangoの学習が目的であることから、あまりメインではないhtml部分やその他静的コンテンツについては、特に解説はしません。画像やCSS, JSファイルは下記からダウンロードいただき、所定のフォルダに配置し環境を構築してください。

## ベーステンプレートの作成
ベーステンプレートとは、複数画面に渡って共通で表示したいヘッダ部分であったり、デザインを外出しで定義できる機能になります。

実際に作成してみましょう。ベーステンプレートもその他テンプレートと同様、templates/amazonの下に.htmlファイルとして作成します。

```
techpit/
　 ├ amazon/
　 ├ static/
　 ├ manage.py
　 ├ templates/ 
 　　└ amazon/
　　　　├ lp.html
　     └ base.html # 新規作成 

```

base.py

```
{% load static %}
<!doctype html>
<html lang="ja">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- vender js start-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
    <!-- vender js end  -->
    <!-- vender css start -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <!-- Font awesome 5 -->
    <!-- <link href="fonts/fontawesome/css/fontawesome-all.min.css" type="text/css" rel="stylesheet"> -->

    <!-- plugin: owl carousel  -->
    <link href="{% static 'plugins/owlcarousel/assets/owl.carousel.min.css' %}" rel="stylesheet">
    <link href="{% static 'plugins/owlcarousel/assets/owl.theme.default.css' %}" rel="stylesheet">
    <script src="{% static 'plugins/owlcarousel/owl.carousel.min.js' %}"></script>

    <!-- custom style -->
    <link href="{% static 'css/ui.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'css/responsive.css' %}" rel="stylesheet" media="only screen and (max-width: 1200px)" />
    <!-- vender css end-->
    
    <!-- custom javascript -->
    <script src="{% static 'js/script.js' %}" type="text/javascript"></script>



    <title>techpit amazon</title>
    <body>
        <header class="section-header">
            <section class="header-main">
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-md-3">
                        <a href="{% url 'amazon:lp' %}">
                            <div class="brand-wrap">
                                <img class="logo" src="{% static 'images/logo-dark.png' %}">
                                <h2 class="logo-text">Techpit amazon</h2>
                            </div> <!-- brand-wrap.// -->
                        </a>
                        </div>
                        <div class="col-lg-6 col-sm-6">
                            <form method= "get" action="{% url 'amazon:item_list' %}" class="search-wrap">
                                <div class="input-group">
                                    <input name="q" type="text" class="form-control" placeholder="Search">
                                    <div class="input-group-append">
                                        <button id="id_search_button" class="btn btn-warning" type="submit">
                                        <i class="fa fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </form> <!-- search-wrap .end// -->
                        </div> <!-- col.// -->
                        <div class="col-lg-3 col-sm-6">
                            <div class="widgets-wrap d-flex justify-content-end">
                                {% if user.is_authenticated %}
                                <div class="widget-header">
                                    <a href="{% url 'amazon:cart' user.cart.pk %}" class="icontext">
                                        <div class="icon-wrap icon-sm bg2 round text-secondary"><i class="fa fa-shopping-cart"></i></div>
                                        <div class="text-wrap">
                                            <small>カート</small>
                                            <span>{{ user.cart.item_count }}商品</span>
                                        </div>
                                    </a>
                                </div> <!-- widget .// -->
                                {% endif %}
                                <div class="widget-header icontext">
                                    <div class="icon-wrap icon-sm bg2 round text-secondary"><i class="fa fa-user"></i></div>
                                    <div class="text-wrap">
                                        {% if user.is_authenticated %}
                                        <small>{{user.name}}さん</small>
                                        <span><a href="{% url 'amazon:logout' %}">Logout</a></span>
                                        {% else %}
                                        <small>ゲスト</small>
                                        <span><a href="{% url 'amazon:login' %}">Login</a></span>
                                        {% endif %}
                                    </div>
                                
                                </div> <!-- widget  dropdown.// -->
                            </div>	<!-- widgets-wrap.// -->	
                        </div> <!-- col.// -->
                    </div> <!-- row.// -->
                </div> <!-- container.// -->
            </section> <!-- header-main .// -->
        </header> <!-- section-header.// -->
        <div class="container" style="padding: 2rem">
                {% block content %}{% endblock %}
        </div>
         <!-- ========================= FOOTER ========================= -->
        <footer class="section-footer bg2">
            <div class="container">
                <section class="footer-bottom row">
                    <div class="col-sm-6"> 
                        <p> Made by S.Ishikawa</p>
                    </div>
                    <div class="col-sm-6">
                        <p class="text-sm-right">
        Copyright &copy 2019 <br>
        <a href="#">Techpit</a>
                        </p>
                    </div>
                </section> <!-- //footer-top -->
            </div><!-- //container -->
        </footer>
        <!-- ========================= FOOTER END // ========================= -->

        <script type="text/javascript">
             function getCookie(name) {
                var cookieValue = null;
                if (document.cookie && document.cookie !== '') {
                    var cookies = document.cookie.split(';');
                    for (var i = 0; i < cookies.length; i++) {
                        var cookie = jQuery.trim(cookies[i]);
                        // Does this cookie string begin with the name we want?
                        if (cookie.substring(0, name.length + 1) === (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                return cookieValue;
            }

            var csrftoken = getCookie('csrftoken');

            function csrfSafeMethod(method) {
                // these HTTP methods do not require CSRF protection
                return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
            }

            $.ajaxSetup({
                beforeSend: function (xhr, settings) {
                    if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                        xhr.setRequestHeader("X-CSRFToken", csrftoken);
                    }
                }
            });   
        </script>
         {% block scripts %}{% endblock %}
    </body>
</html>

```

では解説していきます。

* `{% load static %}`
    * 各アプリフォルダのstaticフォルダ、およびsettings.pyに定義したSTATIC_DIRSに記述したフォルダ下にあるファイルに対し、{% static 'xxx' %}という記述でアクセスできるようにするおまじないです。例を挙げると、`<link href="{% static 'css/ui.css' %}" rel="stylesheet" type="text/css"/>`という記載がありますが、これはamazon/staticの下のcss/ui.cssファイルを読み込むという一文になります。
* `{% block <ブロック名> %}{% endblock %}`
    * 各ページの独自部分を挿入する部分です。このペーステンプレートを利用するテンプレートでは、このblock部分をそれぞれ実装します。

* `{% url '<app名>:<ルーティング名>' %}`
    * 別ページへのリンクを意味します。`url 'amazon:'`
 

